<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Getting You All Setup - Africave</title>
    <link rel="stylesheet" href="./css/fonts/stylesheet.css" />
    <link rel="stylesheet" href="./css/on-boarding.css" />
    <link rel="shortcut icon" href="./img/favicon.ico" type="image/x-icon" />
    <link
      href="https://fonts.googleapis.com/css?family=Montserrat|Didact+Gothic|Open+Sans&display=swap"
      rel="stylesheet"
    />
    <script src="./jquery-UI/jquery.min.js"></script>

    <!-- jquery-ui-links -->
    <link rel="stylesheet" href="./jquery-UI/jquery-ui.min.css" />
    <script src="./jquery-UI/jquery-ui.min.js"></script>
  </head>
  <body>
    <div class="main">
      <div class="thanks">
        <div class="content">
          <div class="text">
            <h1>Get connected to developers from Africave</h1>
            <!-- <p>
              Thanks for your interest in hiring through Africave! Before we get started, weâ€™d like to ask a few questions to better understand your business needs.
            </p> -->
          </div>
          <!-- <div class="svg-rapper">
            <img src="./img/fist.png" alt="" srcset="" />
          </div> -->
        </div>
      </div>
      <div class="form-container">
        <nav>
          <a href="./index" class="logo"
            ><img src="./img/logo.png" alt="" srcset=""
          /></a>
          <p class="tag">Building a Project</p>
        </nav>
        <div class="forms">
          <!-- step one form -->
          <form class="step active" id="step_one">
            <div class="sub-step question">
              <p class="sub-heading">
                What is the title of this project? Hint : Keep it short
              </p>
              <input
                placeholder="Project Title eg Africave Mobile App"
                class="stroked-input js-company_name"
                id=""
                type="text"
                maxlength="64"
                name="title"
              />
            </div>
            <div class="sub-step question" name="PROJECT_TYPE">
              <p class="sub-heading">
                What type of project are you building?
              </p>
              <div class="check-box-container js-dashboard-types-container">
                <span class="check-box-rapper">
                  <span class="custom-check-box-rapper">
                    <input type="radio" value="1" class="check-box" />
                    <span class="custom-check-box type-radio"></span>
                  </span>
                  <span class="title">New Idea or Project</span>
                </span>
                <span class="check-box-rapper">
                  <span class="custom-check-box-rapper">
                    <input type="radio" value="2" class="check-box" />
                    <span class="custom-check-box type-radio"> </span></span
                  ><span class="title"
                    >Existing project that needs more resources
                  </span>
                </span>
              </div>
            </div>

            <div class="sub-step question" name="SPECIFICATION">
              <p class="sub-heading">
                Do you have product specification ready?
              </p>
              <div class="check-box-container js-dashboard-types-container">
                <span class="check-box-rapper">
                  <span class="custom-check-box-rapper">
                    <input type="radio" value="2" class="check-box" />
                    <span class="custom-check-box type-radio"></span>
                  </span>
                  <span class="title">Yes, I have specifications</span>
                </span>
                <span class="check-box-rapper">
                  <span class="custom-check-box-rapper">
                    <input type="radio" value="1" class="check-box" />
                    <span class="custom-check-box type-radio"> </span></span
                  ><span class="title">No, I don't have any specification</span>
                </span>
                <span class="check-box-rapper">
                  <span class="custom-check-box-rapper">
                    <input type="radio" value="3" class="check-box" />
                    <span class="custom-check-box type-radio"> </span></span
                  ><span class="title"
                    >I have a rough Idea of what I want to build</span
                  >
                </span>
              </div>
            </div>

            <div class="sub-step question" name="PROTOTYPE">
              <p class="sub-heading">Do you have a prototype ready?</p>
              <div class="check-box-container js-dashboard-types-container">
                <span class="check-box-rapper">
                  <span class="custom-check-box-rapper">
                    <input type="radio" value="2" class="check-box" />
                    <span class="custom-check-box type-radio"></span>
                  </span>
                  <span class="title">Yes, I have a prototype ready</span>
                </span>
                <span class="check-box-rapper">
                  <span class="custom-check-box-rapper">
                    <input type="radio" value="1" class="check-box" />
                    <span class="custom-check-box type-radio"> </span></span
                  ><span class="title">No, I don't have a prototype ready</span>
                </span>
                <span class="check-box-rapper">
                  <span class="custom-check-box-rapper">
                    <input type="radio" value="3" class="check-box" />
                    <span class="custom-check-box type-radio"> </span></span
                  ><span class="title"
                    >I have a rough sketch of what I want to build</span
                  >
                </span>
              </div>
            </div>

            <div class="sub-step question" name="DELIVERY">
              <p class="sub-heading">
                When would you like this project delivered?
              </p>
              <div class="check-box-container js-dashboard-types-container">
                <span class="check-box-rapper">
                  <span class="custom-check-box-rapper">
                    <input type="radio" value="1" class="check-box" />
                    <span class="custom-check-box type-radio"></span>
                  </span>
                  <span class="title">1-3 months</span>
                </span>
                <span class="check-box-rapper">
                  <span class="custom-check-box-rapper">
                    <input type="radio" value="2" class="check-box" />
                    <span class="custom-check-box type-radio"> </span></span
                  ><span class="title">3-6 months</span>
                </span>
                <span class="check-box-rapper">
                  <span class="custom-check-box-rapper">
                    <input type="radio" value="3" class="check-box" />
                    <span class="custom-check-box type-radio"> </span></span
                  ><span class="title">Greater than 6 months</span>
                </span>
              </div>
            </div>

            <div class="sub-step question">
              <p class="sub-heading">
                What is your preferred technology for the project
              </p>
              <div class="list-input-rapper js-list-input" name="technology">
                <div class="list-input">
                  <div class="select-rapper">
                    <select class="stroked-input js-type-area js-tools">
                      <option disabled value="" selected
                        >Select Technology</option
                      >
                    </select>
                  </div>
                </div>
                <div class="list js-list"></div>
              </div>
            </div>

            <textarea
              placeholder="Description (optional)"
              class="stroked-input js-company_name"
              id=""
              rows="5"
              name="description"
            ></textarea>

            <div class="ctrls">
              <a href="./company-signup.html" class="co-blue">Back</a>
              <input type="submit" class="bg-blue btn js-nxtBtn" value="Next" />
            </div>
          </form>
          <!-- end of step one -->
          <!-- step two form  -->
          <form class="step" id="step_two">
            <div class="sub-step question">
              <input
                type="text"
                placeholder="Company / Individual Name"
                class="stroked-input js-company_name"
                name="company_name"
                maxlength="100"
              />
              <div class="errors"></div>
              <input
                type="text"
                placeholder="Contact Name"
                class="stroked-input js-contact_name"
                name="contact_name"
                maxlength="50"
              />
              <div class="errors"></div>
              <input
                type="number"
                placeholder="Contact Phone Number"
                class="stroked-input js-phone_number"
                name="phone_number"
                max="999999999999999"
              />
              <div class="errors"></div>
              <input
                type="email"
                placeholder="Contact Email Address"
                class="stroked-input js-email"
                name="email"
              />
              <div class="errors"></div>
            </div>
            <div class="ctrls">
              <button type="button" class="co-blue js-prevBtn">Back</button>
              <input type="submit" class="bg-blue btn js-nxtBtn" value="Next" />
            </div>
          </form>
          <!-- end of step two -->
          <!-- step three form -->
          <form class="step" id="step_three">
            <input
              type="password"
              placeholder="Create passsword"
              id="password"
              class="stroked-input"
              name="password"
            />
            <div class="errors"></div>
            <input
              type="password"
              placeholder="Confirm passsword"
              id="confirm_password"
              class="stroked-input"
              name="password_confirmation"
            />
            <p class="heading">
              Schedule a meeting with Africave to get developers on your project
            </p>
            <!-- Calendly inline widget begin -->
            <div
              class="calendly-inline-widget"
              data-url="https://calendly.com/africave"
              style="min-width: 320px; height: 630px;"
            ></div>
            <script
              type="text/javascript"
              src="https://assets.calendly.com/assets/external/widget.js"
            ></script>
            <!-- Calendly inline widget end -->
            <div class="check-box-container">
              <span class="check-box-rapper tick">
                <span class="custom-check-box-rapper">
                  <input
                    type="checkbox"
                    class="check-box js-I-agree"
                    required />
                  <span class="custom-check-box">
                    <img
                      class="tick"
                      src="./svg/whitetick.svg"
                      alt=""
                      srcset=""
                    /> </span
                ></span>
                <span class="txt"
                  >I agree with Africave's privacy policy and terms of
                  service.</span
                ></span
              >
            </div>
            <div class="ctrls">
              <button type="button" class="co-blue js-prevBtn">Back</button>
              <button type="submit" class="bg-blue btn">All Done</button>
            </div>
          </form>
          <!-- end of step three -->
        </div>
      </div>
    </div>

    <script src="./js/common.js"></script>
    <script src="./js/on-boarding.js"></script>
    <script>
      getnadd(toolsEndpoint, document.querySelector(".js-tools"));
      const stepOne = document.querySelector("#step_one"),
        stepTwo = document.querySelector("#step_two"),
        stepThree = document.querySelector("#step_three"),
        password = document.querySelector("#password"),
        confirm_password = document.querySelector("#confirm_password");

      //check session storage for client email
      const client_email = sessionStorage.getItem("client_email");
      client_email ? (stepTwo.email.value = client_email) : false;

      let stepOneData = {},
        stepTwoData = {},
        stepThreeData = {},
        finalData = {
          dashboard_type: "2",
        };

      const validatePassword = () => {
        if (password.value != confirm_password.value) {
          confirm_password.setCustomValidity("Passwords Don't Match");
        } else {
          confirm_password.setCustomValidity("");
        }
      };

      password.onchange = validatePassword;
      confirm_password.onkeyup = validatePassword;

      stepOne.addEventListener("submit", () => {
        store_form_data(stepOne, stepOneData);
        // console.log(stepOneData);
      });

      stepTwo.addEventListener("submit", () => {
        stepTwo.querySelectorAll(".errors").forEach((e) => (e.innerHTML = ""));
        store_form_data(stepTwo, stepTwoData);

        const options = {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            Accept: "application/json",
          },
          body: JSON.stringify(stepTwoData),
        };
        // console.log(stepTwoData);

        fetch(basicValidation, options)
          .then((res) => {
            return res.json();
          })
          .then((object) => {
            if (
              object.email ||
              object.company_name ||
              object.contact_name ||
              object.phone_number
            ) {
              currentStepIndex--;
              updateCurrentStep();
            }
            const errorfy = (name) => {
              if (object[name]) {
                object[name].forEach((e) => {
                  stepTwo.querySelector(
                    `.js-${name} + .errors`
                  ).innerHTML += `<p>${e}</p>`;
                });
              }
            };
            errorfy("company_name");
            errorfy("contact_name");
            errorfy("phone_number");
            errorfy("email");
          });
      });

      stepThree.addEventListener("submit", () => {
        store_form_data(stepThree, stepThreeData);
        submitFinalForm();
      });

      const submitFinalForm = () => {
        finalData = Object.assign(
          {},
          finalData,
          stepOneData,
          stepTwoData,
          stepThreeData
        );
        stepThree.querySelector("#password + .errors").innerHTML = "";
        stepThree
          .querySelector("button[type=submit]")
          .classList.add("loading-btn");

        fetch(clientOnboarding, {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            Accept: "application/json",
          },
          body: JSON.stringify(finalData),
        })
          .then((res) => {
            return res.json();
          })
          .then((obj) => {
            stepThree
              .querySelector("button[type=submit]")
              .classList.remove("loading-btn");

            console.log(obj);
            if (obj.password) {
              obj.password.forEach((error) => {
                stepThree.querySelector(
                  "#password + .errors"
                ).innerHTML += `<p>${error}</p>`;
              });
            }
            if (obj.success) {
              localStorage.setItem("AfricaveLoginData", JSON.stringify(obj));
              window.location.href = `email/validate`;
            }
          });
      };
    </script>
  </body>
</html>
